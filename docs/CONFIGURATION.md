# Plonk Configuration

Plonk uses two configuration files located in `~/.config/plonk/`:

## plonk.lock

The lock file is automatically maintained by plonk and tracks your managed resources. Do not edit this file manually.

**Format:**
```yaml
version: 2
packages:
  brew:
    - name: ripgrep
      version: 14.0.3
      installed_at: 2025-07-27T11:01:03.519704-06:00
    - name: fd
      version: 8.7.0
      installed_at: 2025-07-27T11:00:51.028708-06:00
  npm:
    - name: prettier
      version: 3.1.0
      installed_at: 2025-07-28T15:11:08.74692-06:00
```

**Note:** Dotfiles are not tracked in the lock file. Instead, the filesystem structure of `$PLONK_DIR` itself represents the dotfile state (see [Filesystem as State](#filesystem-as-state)).

## Filesystem as State

Plonk uses the filesystem structure of `$PLONK_DIR` to represent dotfile state. The contents of this directory define what dotfiles are managed:

```
$PLONK_DIR/
├── plonk.yaml        # Configuration (not a dotfile)
├── plonk.lock        # Package state (not a dotfile)
├── zshrc             # Deployed to ~/.zshrc
├── gitconfig         # Deployed to ~/.gitconfig
└── config/
    └── nvim/
        └── init.lua  # Deployed to ~/.config/nvim/init.lua
```

This approach provides several benefits:
- No separate tracking file needed for dotfiles
- Easy to see what's managed by examining the directory
- Git-native workflow (the directory is your repository)
- Impossible for tracking and filesystem to get out of sync

## plonk.yaml (Optional)

User configuration file for customizing plonk behavior. This file is optional - plonk works with sensible defaults.

**Example:**
```yaml
# Default package manager (if not specified in commands)
default_manager: brew

# Dotfile management settings
dotfiles:
  # Patterns to ignore when scanning for dotfiles
  ignore_patterns:
    - "*.swp"
    - "*.tmp"
    - ".DS_Store"
    - ".Trash"
    - ".cache/*"

  # Additional directories to scan for dotfiles
  scan_dirs:
    - "~/.config"
    - "~/.local/share"

# Hook scripts (run before/after apply)
hooks:
  pre_apply:
    - "echo 'Starting plonk apply...'"
  post_apply:
    - "echo 'Apply complete!'"

# Operation timeouts (in seconds)
timeouts:
  install: 300
  search: 30
  list: 60
```

## Environment Variables

- `PLONK_DIR` - Override config directory location (default: `~/.config/plonk`)
- `EDITOR` - Editor to use for `plonk config edit`

## Creating Configuration

```bash
# View current configuration (including defaults)
plonk config show

# Create and edit configuration
plonk config edit
```

## Configuration Precedence

1. Command-line flags (highest priority)
2. Environment variables
3. Configuration file (`plonk.yaml`)
4. Built-in defaults (lowest priority)

## Common Configuration Scenarios

### Use NPM as default package manager
```yaml
default_manager: npm
```

### Ignore specific dotfile patterns
```yaml
dotfiles:
  ignore_patterns:
    - "*.log"
    - "node_modules/*"
    - ".git/*"
```

### Add pre/post hooks
```yaml
hooks:
  pre_apply:
    - "brew update"
  post_apply:
    - "source ~/.zshrc"
```
